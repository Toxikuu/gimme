name: "openssl"
version: "3.3.2"
url: "https://github.com/openssl/openssl/releases/download/openssl-${version}/openssl-${version}.tar.gz"
get: |
  ./config --prefix=/usr         \
           --openssldir=/etc/ssl \
           --libdir=lib          \
           shared                \
           zlib-dynamic          &&
  make &&
  sed -i '/INSTALL_LIBS/s/libcrypto.a libssl.a//' Makefile
  sudo make MANSUFFIX=ssl install
  sudo mv -v /usr/share/doc/openssl /usr/share/doc/openssl-${version}
  sudo cp -vfr doc/* /usr/share/doc/openssl-${version}

  make distclean
  ./config --prefix=/usr         \
         --openssldir=/etc/ssl   \
         --libdir=lib32          \
         shared                  \
         zlib-dynamic            \
         linux-x86

  make &&
  sudo make DESTDIR=$PWD/DESTDIR install
  sudo cp -Rv DESTDIR/usr/lib32/* /usr/lib32
  sudo rm -rf DESTDIR
remove: |
  sudo rm -rv                   \
  /usr/bin/c_rehash             \
  /usr/bin/openssl              \
  /etc/ssl                      \
  /usr/include/openssl          \
  /usr/share/doc/openssl*       \
  /usr/lib{,32}/libssl.so*      \
  /usr/lib{,32}/libcrypto.so*
